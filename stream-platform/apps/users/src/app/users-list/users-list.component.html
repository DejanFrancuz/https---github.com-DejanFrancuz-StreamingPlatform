<div
  *ngIf="users$ | async as users"
  class="py-8 px-20 bg-surface rounded text-text"
>
  <div
    *ngIf="person$ | async as person"
    class="py-8 px-20 bg-surface rounded text-text"
  >
    <h2 class="text-2xl font-semibold mb-6 text-primary">
      List of Active Users
    </h2>

    <div class="overflow-x-auto rounded-lg">
      <table
        mat-table
        [dataSource]="users"
        class="min-w-full divide-y divide-surface-variant"
      >
        <ng-container matColumnDef="userId">
          <th mat-header-cell *matHeaderCellDef>User ID</th>
          <td mat-cell *matCellDef="let user">{{ user.userId }}</td>
        </ng-container>
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef>Email</th>
          <td mat-cell *matCellDef="let user">{{ user.email }}</td>
        </ng-container>
        <ng-container matColumnDef="username">
          <th mat-header-cell *matHeaderCellDef>Username</th>
          <td mat-cell *matCellDef="let user">{{ user.username }}</td>
        </ng-container>
        <ng-container matColumnDef="firstName">
          <th mat-header-cell *matHeaderCellDef>First Name</th>
          <td mat-cell *matCellDef="let user">{{ user.firstName }}</td>
        </ng-container>
        <ng-container matColumnDef="lastName">
          <th mat-header-cell *matHeaderCellDef>Last Name</th>
          <td mat-cell *matCellDef="let user">{{ user.lastName }}</td>
        </ng-container>
        <ng-container matColumnDef="role">
          <th mat-header-cell *matHeaderCellDef>Role</th>
          <td mat-cell *matCellDef="let user">
            <mat-form-field
              [ngClass]="{ 'opacity-50': person.userId === user.userId }"
              appearance="fill"
            >
              <mat-select
                [disabled]="person.userId === user.userId"
                [value]="user.permissions[0]"
                panelClass="custom-menu"
                (selectionChange)="onRoleChange(user, $event.value)"
              >
                <mat-option *ngFor="let role of roles" [value]="role">{{
                  role
                }}</mat-option>
              </mat-select>
            </mat-form-field>
          </td>
        </ng-container>
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let user">
            <button
              [ngClass]="{ 'opacity-50 cursor-default': person.userId === user.userId }"
              [disabled]="person.userId === user.userId"
              (click)="deleteUser(user.userId)"
              class="material-symbols-outlined cursor-pointer"
            >
              delete
            </button>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>
  </div>
</div>
